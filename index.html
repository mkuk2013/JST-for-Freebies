<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Junior Science Teacher (JST) Mock Test For Freebies</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            /* Light Mode Professional Colors */
            --primary-color: #4A90E2; /* A professional, calming blue */
            --secondary-color: #6A82FB; /* A slightly lighter, vibrant blue */
            --accent-color: #FFC107; /* A warm, inviting yellow for highlights */
            --success-color: #4CAF50; /* Standard green for success */
            --danger-color: #F44347; /* Standard red for danger */
            --warning-color: #FF9800; /* Standard orange for warnings */
            
            --text-primary: #333333; /* Dark gray for main text */
            --text-secondary: #666666; /* Lighter gray for secondary text */
            --bg-primary: #FFFFFF; /* Pure white background */
            --bg-secondary: #F8F9FA; /* Off-white for subtle contrast */
            --border-color: #E0E0E0; /* Light gray for borders */
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-lg: 0 8px 25px rgba(0,0,0,0.12);
        }

        html[data-theme="dark"] {
            /* Dark Mode Colors (Improved for readability) */
            --text-primary: #E0E0E0; /* Light gray for main text */
            --text-secondary: #B0B0B0; /* Slightly darker gray for secondary text */
            --bg-primary: #1A1A1A; /* Dark gray background */
            --bg-secondary: #2C2C2C; /* Slightly lighter dark gray for subtle contrast */
            --border-color: #4A4A4A; /* Darker border for contrast */
            --primary-color: #8A2BE2; /* A vibrant purple for primary elements */
            --secondary-color: #4169E1; /* Royal blue for secondary elements */
            --accent-color: #FFD700; /* Gold for accents */
            --success-color: #7FFF00; /* Chartreuse green for success */
            --danger-color: #FF6347; /* Tomato red for danger */
            --warning-color: #FFA500; /* Orange for warnings */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--bg-secondary); /* Use secondary background for body */
            min-height: 100vh;
            color: var(--text-primary); /* Set default text color */
            overflow-x: hidden;
            position: relative;
        }

        /* Animated Background Particles - Adjusted for light mode */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(0,0,0,0.1); /* Darker particles for light mode */
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        html[data-theme="dark"] .particle {
            background: rgba(255,255,255,0.1); /* Lighter particles for dark mode */
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.1; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 0.3; }
        }

        /* Control Buttons - Adjusted for light mode */
        .control-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .control-btn {
            background: rgba(255,255,255,0.8); /* Slightly transparent white */
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary); /* Dark text for light mode buttons */
            font-size: 1.2rem;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }

        html[data-theme="dark"] .control-btn {
            background: rgba(44,44,44,0.8); /* Darker background for dark mode buttons */
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.9);
            transform: scale(1.1);
            box-shadow: var(--shadow-lg);
        }

        html[data-theme="dark"] .control-btn:hover {
            background: rgba(60,60,60,0.9);
        }

        .control-btn.muted {
            opacity: 0.5;
        }

        /* Main Container */
        .main-container {
            position: relative;
            z-index: 2;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: var(--bg-primary); /* Pure white background */
            border: 1px solid var(--border-color);
            border-radius: 15px; /* Slightly less rounded for professionalism */
            padding: 2.5rem; /* Increased padding */
            width: 100%;
            max-width: 900px;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 2.5rem; /* Increased margin */
            position: relative;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color); /* Primary color for main heading */
            margin-bottom: 0.75rem;
            text-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .header h1 i {
            color: var(--primary-color); /* Primary color for icon */
        }

        .header p {
            color: var(--text-secondary); /* Secondary text color */
            font-size: 1.1rem;
            font-weight: 400; /* Adjusted font weight */
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.75rem; /* Increased margin */
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.6rem; /* Adjusted margin */
            color: var(--text-primary);
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 1rem 1.25rem; /* Adjusted padding */
            border: 1px solid var(--border-color);
            border-radius: 8px; /* Slightly less rounded */
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            background: #EBF2F7;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2);
        }

        html[data-theme="dark"] .form-group input:focus {
            background: #3A3A3A;
            box-shadow: 0 0 0 3px rgba(138, 43, 226, 0.3);
        }

        .form-group input::placeholder {
            color: var(--text-secondary);
        }

        /* Button Styles */
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            /* Ensure consistent height and centered content */
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            width: 100%;
            margin-top: 1.5rem;
            box-shadow: var(--shadow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            opacity: 0.95;
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }

        .btn-secondary:hover {
            background: #EBEFF3;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Progress Bar */
        .progress-container {
            margin-bottom: 2.5rem;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: var(--border-color);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), var(--primary-color));
            border-radius: 5px;
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Question Palette */
        .palette-container {
            margin-top: 2.5rem;
            margin-bottom: 2.5rem;
        }

        .palette-title {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .palette {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
            padding: 1.25rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            gap: 10px;
            padding-bottom: 15px;
            scroll-snap-type: x mandatory;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
            
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--border-color);
        }

        .palette::-webkit-scrollbar {
            height: 8px;
        }

        .palette::-webkit-scrollbar-track {
            background: var(--border-color);
            border-radius: 4px;
        }

        .palette::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 4px;
            border: 2px solid var(--bg-secondary);
        }

        .palette-btn {
            width: 55px;
            height: 55px;
            flex-shrink: 0;
            scroll-snap-align: start;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: var(--shadow);
        }

        .palette-btn:hover {
            transform: scale(1.05);
            background: var(--bg-secondary);
            border-color: var(--primary-color);
            box-shadow: 0 0 15px rgba(74, 144, 226, 0.2);
        }

        html[data-theme="dark"] .palette-btn:hover {
            border-color: var(--primary-color);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
        }

        .palette-btn.current {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
            box-shadow: 0 0 20px rgba(74, 144, 226, 0.4);
        }

        html[data-theme="dark"] .palette-btn.current {
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.5);
        }

        .palette-btn.answered {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }

        .palette-btn.bookmarked::after {
            content: '★';
            position: absolute;
            top: -5px;
            right: -5px;
            color: var(--warning-color);
            font-size: 0.8rem;
            text-shadow: 0 0 5px rgba(0,0,0,0.2);
        }

        /* Question Container */
        .question-container {
            background: var(--bg-primary);
            border-radius: 15px;
            padding: 2.5rem;
            margin-bottom: 2.5rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.75rem;
        }

        .bookmark-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.6rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .bookmark-btn:hover,
        .bookmark-btn.active {
            color: var(--warning-color);
            transform: scale(1.2);
        }

        .question-text {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 2rem;
            line-height: 1.7;
        }

        /* New: Passage Display Container */
        .passage-display {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            line-height: 1.6;
            color: var(--text-primary);
        }
        html[data-theme="dark"] .passage-display {
            background: #2C2C2C;
            border-color: #4A4A4A;
        }

        /* Options */
        .options {
            display: grid;
            gap: 1.25rem;
        }

        .option {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1.2rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .option:hover {
            background: #EBF2F7;
            border-color: var(--primary-color);
            transform: translateX(5px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }

        html[data-theme="dark"] .option:hover {
            background: #3A3A3A;
            border-color: var(--primary-color);
        }

        .option.selected {
            background: rgba(74, 144, 226, 0.1);
            border-color: var(--primary-color);
            box-shadow: 0 0 15px rgba(74, 144, 226, 0.3);
        }

        html[data-theme="dark"] .option.selected {
            background: rgba(138, 43, 226, 0.2);
            border-color: var(--primary-color);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.4);
        }

        .option input[type="radio"] {
            width: 22px;
            height: 22px;
            accent-color: var(--primary-color);
        }

        .option label {
            color: var(--text-primary);
            font-weight: 500;
            cursor: pointer;
            flex: 1;
            font-size: 1.05rem;
        }

        /* Navigation */
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
            margin: 0 auto;
            max-width: 400px;
        }

        .nav-btn {
            padding: 0.9rem 1.8rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            box-shadow: var(--shadow);
            flex: 1;
            min-height: 60px;
        }

        .nav-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            box-shadow: none;
        }

        .nav-btn.prev {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .nav-btn.next {
            background: var(--primary-color);
            color: white;
        }

        .nav-btn.submit {
            background: var(--success-color);
            color: white;
        }

        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            opacity: 0.95;
        }

        /* Ensure text color for answered count */
        .nav-container span {
            color: var(--text-secondary);
        }

        /* Result Screen */
        .result-container {
            text-align: center;
            padding: 2.5rem;
        }

        .result-score {
            font-size: 4.5rem;
            font-weight: 700;
            margin: 1.5rem 0;
            background: linear-gradient(135deg, var(--success-color), var(--primary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .result-status {
            font-size: 1.8rem;
            font-weight: 600;
            margin: 1.5rem 0;
        }

        .result-status.pass {
            color: var(--success-color);
        }

        .result-status.fail {
            color: var(--danger-color);
        }

        .result-details {
            background: var(--bg-secondary);
            border-radius: 15px;
            padding: 2.5rem;
            margin: 2.5rem 0;
            box-shadow: var(--shadow);
        }

        .result-details h3 {
            color: var(--text-primary);
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .result-details p {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mb-2 {
            margin-bottom: 1rem;
        }

        .mt-2 {
            margin-top: 1rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 1.5rem;
            }

            .header h1 {
                font-size: 2rem;
            }

            .palette {
                grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            }

            .palette-btn {
                width: 45px;
                height: 45px;
            }

            .nav-container {
                flex-direction: column;
            }

            .nav-buttons {
                width: 100%;
                max-width: none;
            }

            .control-buttons {
                right: 10px;
                top: 10px;
            }

            .control-btn {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }

            .top-info-bar {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .timer-display-wrapper {
                margin-top: 10px;
            }

            /* Review Modal buttons on small screens */
            #review-modal .modal-buttons-row {
                flex-direction: column;
                align-items: center;
            }

 

            #review-modal .btn-secondary,
            #review-modal .btn-primary {
                width: 100%;
                min-width: unset;
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,0.2);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Important Notice Modal Styles */
        .notice-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1002;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .notice-content {
            background: var(--bg-primary);
            border-radius: 15px;
            padding: 2.5rem;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: var(--shadow-lg);
            color: var(--text-primary);
        }

        .notice-content h2 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .notice-content p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
        }

        .notice-content .btn-primary {
            width: auto;
            padding: 0.8rem 2rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
            max-width: 250px;
            min-height: 60px;
        }

        /* New styles for top info bar */
        .top-info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 0 1rem;
        }

        .question-progress-display {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        .timer-display-wrapper {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--danger-color);
        }

        .timer-display-wrapper .timer {
            color: inherit;
            background: none;
            padding: 0;
            border: none;
            box-shadow: none;
            animation: none;
            font-size: inherit;
            font-weight: inherit;
        }



.modal-buttons-row {
    display: grid;
    grid-template-columns: repeat(2, 200px);
    gap: 1rem;
    justify-content: center;
    align-items: flex-end;
    margin-bottom: 20px;
}

#review-modal .btn-secondary,
#review-modal .btn-primary {
    width: 200px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    font-weight: 600;
    line-height: 1;
    box-sizing: border-box;
    padding: 0.75rem 1rem;
    white-space: nowrap;
}

#review-modal .modal-buttons-row i {
    margin-right: 8px;
    font-size: 1rem;
    line-height: 1;
    position: relative;
    top: 0;
}

    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <div class="control-buttons">
        <button class="control-btn" id="theme-toggle" title="Theme Toggle">
            <i class="fas fa-moon" id="theme-icon"></i>
        </button>
        <button class="control-btn" id="fullscreen-toggle" title="Fullscreen">
            <i class="fas fa-expand" id="fullscreen-icon"></i>
        </button>
    </div>

    <div class="main-container">
        <div class="container">
            <div id="welcome-screen">
                <div class="header">
                    <h1><i class="fas fa-graduation-cap"></i> Junior Science Teacher (JST) Mock Test For Freebies</h1>
                    <p>Apne knowledge ko test karein aur JST exam ke liye tayyar ho jayen!</p>
                </div>

                <div class="form-group">
                    <label for="name"><i class="fas fa-user"></i> Apka Naam</label>
                    <input type="text" id="name" placeholder="Yahan apna naam likhiye..." required>
                </div>

                <div class="form-group">
                    <label for="email"><i class="fas fa-envelope"></i> Email Address</label>
                    <input type="email" id="email" placeholder="example@email.com" required>
                </div>


                <button class="btn btn-primary" id="start-test-btn">
                    <i class="fas fa-play"></i> Test Shuru Kariye
                </button>

                <div class="mt-2 text-center">
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">
                        <i class="fas fa-clock"></i> Test ka waqt: 100 minutes | 
                        <i class="fas fa-question-circle"></i> Total Questions: 100 |
                        <i class="fas fa-check-circle"></i> Pass Marks: 40%
                    </p>
                </div>
            </div>

            <div id="test-screen" class="hidden">
                <div class="top-info-bar">
                    <div class="question-progress-display" id="question-progress-display">
                        </div>
                    <div class="timer-display-wrapper">
                        <i class="fas fa-clock"></i> <span class="timer" id="timer">Time Left: 100:00</span>
                    </div>
                </div>

                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                    </div>

                <div class="question-container">
                    <div class="question-header">
                        <div class="question-number" id="question-number">Question 1</div>
                        <button class="bookmark-btn" id="bookmark-btn" title="Bookmark this question">
                            <i class="fas fa-bookmark"></i>
                        </button>
                    </div>
                    <div class="passage-display hidden" id="passage-display">
                        </div>
                    <div class="question-text" id="question-text">
                        </div>
                    <div class="options" id="options">
                        </div>
                </div>

                <div class="nav-container">
                    <div class="nav-buttons">
                        <button class="nav-btn prev" id="prev-btn" disabled>
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>
                        <button class="nav-btn next" id="next-btn">
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                        <button class="nav-btn submit hidden" id="submit-btn">
                            <i class="fas fa-check"></i> Review & Submit
                        </button>
                    </div>
                    
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        <span id="answered-count">0</span> answered out of <span id="total-questions">100</span>
                    </div>
                </div>

                <div class="palette-container">
                    <div class="palette-title">
                        <i class="fas fa-th"></i> Question Navigator
                        <span style="margin-left: auto; font-size: 0.9rem;">
                            <span style="color: var(--success-color);">● Answered</span>
                            <span style="color: var(--primary-color); margin-left: 1rem;">● Current</span>
                            <span style="color: var(--warning-color); margin-left: 1rem;">★ Bookmarked</span>
                        </span>
                    </div>
                    <div class="palette" id="palette"></div>
                </div>
            </div>

            <div id="result-screen" class="hidden">
                <div class="result-container">
                    <div class="header">
                        <h1><i class="fas fa-trophy"></i> Apka Result</h1>
                    </div>

                    <div class="result-score" id="result-score">0 / 100</div>
                    <div class="result-status" id="result-status"></div>

                    <div class="result-details">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div>
                                <h3 style="color: var(--success-color);"><i class="fas fa-check-circle"></i> Correct</h3>
                                <p style="font-size: 2rem; font-weight: 700;" id="correct-count">0</p>
                            </div>
                            <div>
                                <h3 style="color: var(--danger-color);"><i class="fas fa-times-circle"></i> Incorrect</h3>
                                <p style="font-size: 2rem; font-weight: 700;" id="incorrect-count">0</p>
                            </div>
                            <div>
                                <h3 style="color: var(--warning-color);"><i class="fas fa-clock"></i> Time Taken</h3>
                                <p style="font-size: 2rem; font-weight: 700;" id="time-taken">0:00</p>
                            </div>
                            <div>
                                <h3 style="color: var(--accent-color);"><i class="fas fa-percentage"></i> Percentage</h3>
                                <p style="font-size: 2rem; font-weight: 700;" id="percentage">0%</p>
                            </div>
                        </div>
                    </div>

                    <div class="nav-buttons">
                        <button class="btn btn-primary" id="certificate-btn" style="display: none;">
                            <i class="fas fa-download"></i> Certificate Download
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="notice-modal" class="notice-modal">
        <div class="notice-content">
            <h2><i class="fas fa-info-circle"></i> Aham Elaan</h2>
            <p>
                Test dene se pehle aap ko batate chalen ke yeh ek Free Mock Test hai. Aap sirf ek hi baar test de sakte hain. 
                Ek baar test submit hone ke baad, aap apne system se dobara test nahin de sakte.
            </p>
            <p>Aap ke taawun ka behad shukriya.</p>
            <button class="btn btn-primary" id="close-notice-modal-btn">
                <i class="fas fa-check-circle"></i> Samajh Gaya
            </button>
        </div>
    </div>

    <div id="review-modal" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; display: flex; align-items: center; justify-content: center;">
        <div style="background: var(--bg-primary); border-radius: 15px; padding: 2.5rem; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: var(--shadow-lg);">
            <h2 style="color: var(--primary-color); margin-bottom: 1.5rem;"><i class="fas fa-eye"></i> Final Review</h2>
            <div class="modal-buttons-row">
               
                <button class="btn btn-secondary" id="close-review-modal-btn"><i class="fas fa-arrow-left"></i> Back to Test </button>
                <button class="btn btn-primary" id="final-submit-btn">
                    <i class="fas fa-check"></i> Final Submit
                </button>
            </div>
            <hr style="border-color: var(--border-color); margin-bottom: 1.5rem;">
            <div id="review-content" style="color: var(--text-primary);"></div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
        import { getAuth, signInAnonymously } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
        import { getFirestore, collection, addDoc, query, where, getDocs, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDX3UMTlZiCB0CL9yAeJnuzKg022jbEJEY",
            authDomain: "mocktestapp-353db.firebaseapp.com",
            projectId: "mocktestapp-353db",
            storageBucket: "mocktestapp-353db.firebaseapp.com",
            messagingSenderId: "658583028202",
            appId: "1:658583028202:web:d3c264ce467fab3a61b293",
            measurementId: "G-HVTV85W3Z4"
        };

        // Initialize Firebase
        let auth, db;
        let firebaseInitialized = false; // Flag to track Firebase initialization status

        try {
            const app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            firebaseInitialized = true; // Set flag to true on successful initialization
            console.log('Firebase successfully initialized.');
        } catch (error) {
            console.error('Firebase initialization error:', error);
            // alert('Firebase initialization failed. Please check your console.'); // Removed alert as per instructions
        }

        /*
         * IMPORTANT: Firestore Security Rules Configuration
         *
         * Aapko apne Firebase project mein Firestore security rules ko update karna hoga
         * taake yeh application data ko read aur write kar sake.
         *
         * Firebase Console (Firestore -> Rules tab) mein in rules ko copy paste karein:
         *
         * rules_version = '2';
         * service cloud.firestore {
         * match /databases/{database}/documents {
         * // Rule for the 'results' collection at the root level
         * // This rule allows any authenticated user (including anonymous) to READ, WRITE, and DELETE data from the 'results' collection.
         * match /results/{document=**} {
         * allow read, write, delete: if request.auth != null;
         * }
         * }
         * }
         *
         * Yeh rules kisi bhi authenticated user (anonymous users bhi shamil hain) ko
         * 'results' collection mein data read, write, aur delete karne ki ijazat denge.
         *
         * Agar aapko ab bhi permissions ka masla aata hai, to confirm karein ke:
         * 1. Aapne rules sahi tarah se deploy kiye hain.
         * 2. Aapka Firebase config sahi hai.
         * 3. Browser console mein koi aur error nahi hai.
         */

        // Enhanced Questions in Roman Urdu
        const questions = [
            { 
                question: "1. What is the main theme of the passage?", 
                passage: "Sindh, the land of mystics and ancient civilizations, holds a profound cultural heritage. Its vibrant traditions, folk music, and Sufi poetry are woven through centuries, reflecting the resilience and spiritual depth of its people. From the bustling bazaars of Karachi to the tranquil banks of the Indus, the spirit of Sindh echoes in every corner. Despite modern challenges, the community strives to preserve its history, passing down tales of valor and wisdom from generation to generation. Folk songs, in particular, act as living archives, narrating the region's struggles and triumphs. They band together people from diverse backgrounds, fostering a sense of unity. The fertile plains, nurtured by the mighty Indus River, have witnessed countless eras, each leaving its indelible mark on the land and its culture.",
                options: ["Urban growth in Sindh", "Preservation of cultural heritage", "Economic benefits", "Political changes"], 
                answer: "Preservation of cultural heritage", 
                subject: "English" 
            },
            { 
                question: "2. 'Woven through centuries' means:", 
                passage: "Sindh, the land of mystics and ancient civilizations, holds a profound cultural heritage. Its vibrant traditions, folk music, and Sufi poetry are woven through centuries, reflecting the resilience and spiritual depth of its people. From the bustling bazaars of Karachi to the tranquil banks of the Indus, the spirit of Sindh echoes in every corner. Despite modern challenges, the community strives to preserve its history, passing down tales of valor and wisdom from generation to generation. Folk songs, in particular, act as living archives, narrating the region's struggles and triumphs. They band together people from diverse backgrounds, fostering a sense of unity. The fertile plains, nurtured by the mighty Indus River, have witnessed countless eras, each leaving its indelible mark on the land and its culture.",
                options: ["Recently invented", "Gradually integrated", "Easily forgotten", "Structurally unstable"], 
                answer: "Gradually integrated", 
                subject: "English" 
            },
            { 
                question: "3. Folk songs are described as:", 
                passage: "Sindh, the land of mystics and ancient civilizations, holds a profound cultural heritage. Its vibrant traditions, folk music, and Sufi poetry are woven through centuries, reflecting the resilience and spiritual depth of its people. From the bustling bazaars of Karachi to the tranquil banks of the Indus, the spirit of Sindh echoes in every corner. Despite modern challenges, the community strives to preserve its history, passing down tales of valor and wisdom from generation to generation. Folk songs, in particular, act as living archives, narrating the region's struggles and triumphs. They band together people from diverse backgrounds, fostering a sense of unity. The fertile plains, nurtured by the mighty Indus River, have witnessed countless eras, each leaving its indelible mark on the land and its culture.",
                options: ["Entertainment", "Living archives", "Religious chants", "Commercial products"], 
                answer: "Living archives", 
                subject: "English" 
            },
            { 
                question: "4. Which phrase indicates community unity?", 
                passage: "Sindh, the land of mystics and ancient civilizations, holds a profound cultural heritage. Its vibrant traditions, folk music, and Sufi poetry are woven through centuries, reflecting the resilience and spiritual depth of its people. From the bustling bazaars of Karachi to the tranquil banks of the Indus, the spirit of Sindh echoes in every corner. Despite modern challenges, the community strives to preserve its history, passing down tales of valor and wisdom from generation to generation. Folk songs, in particular, act as living archives, narrating the region's struggles and triumphs. They band together people from diverse backgrounds, fostering a sense of unity. The fertile plains, nurtured by the mighty Indus River, have witnessed countless eras, each leaving its indelible mark on the land and its culture.",
                options: ["'woven through centuries'", "'dust rises red'", "'band together'", "'rivers flow calm'"], 
                answer: "'band together'", 
                subject: "English" 
            },
            { 
                question: "5. The tone of the passage is:", 
                passage: "Sindh, the land of mystics and ancient civilizations, holds a profound cultural heritage. Its vibrant traditions, folk music, and Sufi poetry are woven through centuries, reflecting the resilience and spiritual depth of its people. From the bustling bazaars of Karachi to the tranquil banks of the Indus, the spirit of Sindh echoes in every corner. Despite modern challenges, the community strives to preserve its history, passing down tales of valor and wisdom from generation to generation. Folk songs, in particular, act as living archives, narrating the region's struggles and triumphs. They band together people from diverse backgrounds, fostering a sense of unity. The fertile plains, nurtured by the mighty Indus River, have witnessed countless eras, each leaving its indelible mark on the land and its culture.",
                options: ["Critical", "Nostalgic yet hopeful", "Satirical", "Indifferent"], 
                answer: "Nostalgic yet hopeful", 
                subject: "English" 
            },
            { question: "6. 'Break the ice' means:", options: ["Create conflict", "Start a conversation", "Freeze something", "Stop a joke"], answer: "Start a conversation", subject: "English" },
            { question: "7. 'Cost an arm and a leg' means:", options: ["Very painful", "Extremely expensive", "Very easy", "Free"], answer: "Extremely expensive", subject: "English" },
            { question: "8. 'Hit the nail on the head' means:", options: ["Be accurate", "Cause damage", "Misunderstand", "Lose confidence"], answer: "Be accurate", subject: "English" },
            { question: "9. 'Speak of the devil' means:", options: ["Curse someone", "Someone appears after being mentioned", "Avoid mentioning a name", "Talk about evil"], answer: "Someone appears after being mentioned", subject: "English" },
            { question: "10. 'Bite the bullet' means:", options: ["Avoid conflict", "Endure pain bravely", "Take revenge", "Use a weapon"], answer: "Endure pain bravely", subject: "English" },
            { question: "11. By the time the guests arrived, she ________ cooking.", options: ["finished", "had finished", "has finished", "finishes"], answer: "had finished", subject: "English" },
            { question: "12. If he ________ harder, he would pass.", options: ["had studied", "studies", "will study", "study"], answer: "studies", subject: "English" },
            { question: "13. Next month, she ________ her internship.", options: ["will start", "starts", "would start", "will have started"], answer: "will start", subject: "English" },
            { question: "14. Identify the subordinate clause: 'Although it rained, the farmers who planted rice were hopeful.'", options: ["Although it rained", "the farmers", "who planted rice", "were hopeful"], answer: "who planted rice", subject: "English" },
            { question: "15. Which is a simile?", options: ["His mind was a fortress.", "She danced like the wind.", "Time marches on.", "The city sleeps."], answer: "She danced like the wind.", subject: "English" },
            { question: "16. He said, 'I will arrive tomorrow.' → Indirect speech:", options: ["He said he will arrive tomorrow.", "He said he would arrive the next day.", "He said he arrives tomorrow.", "He said arriving tomorrow."], answer: "He said he would arrive the next day.", subject: "English" },
            { question: "17. 'The teacher explained the lesson.' → Passive:", options: ["The lesson was explained by the teacher.", "The lesson is explained by the teacher.", "The teacher explained the lesson.", "The lesson explained the teacher."], answer: "The lesson was explained by the teacher.", subject: "English" },
            { question: "18. 'They built the bridge in 1995.' → Correct passive:", options: ["The bridge built in 1995.", "The bridge was built in 1995.", "The bridge is built in 1995.", "The bridge had been built in 1995."], answer: "The bridge was built in 1995.", subject: "English" },
            { question: "19. Correct: 'She don't know Sindhi idioms.'", options: ["doesn't", "do not", "don't knows", "not know"], answer: "doesn't", subject: "English" },
            { question: "20. Correct pronoun: 'Between you and I, this is unique.'", options: ["Between you and me", "Between you and mine", "Between me and you", "Between my friend and me"], answer: "Between you and me", subject: "English" },
            { question: "21. 'Powerhouse' of the cell?", options: ["Nucleus", "Mitochondria", "Chloroplast", "Ribosome"], answer: "Mitochondria", subject: "Biology" },
            { question: "22. Photosynthesis occurs in:", options: ["Root cells", "Leaf mesophyll", "Stem phloem", "Guard cells"], answer: "Leaf mesophyll", subject: "Biology" },
            { question: "23. Largest human organ?", options: ["Heart", "Skin", "Liver", "Brain"], answer: "Skin", subject: "Biology" },
            { question: "24. Blood cell that fights infection:", options: ["RBC", "WBC", "Platelet", "Plasma"], answer: "WBC", subject: "Biology" },
            { question: "25. Genetic material housed in:", options: ["Cytoplasm", "Nucleus", "Mitochondria", "Ribosome"], answer: "Nucleus", subject: "Biology" },
            { question: "26. Plant transport vessel for water:", options: ["Phloem", "Xylem", "Cortex", "Epidermis"], answer: "Xylem", subject: "Biology" },
            { question: "27. Enzyme in saliva:", options: ["Amylase", "Lipase", "Protease", "Lactase"], answer: "Amylase", subject: "Biology" },
            { question: "28. Mosquito disease vector:", options: ["Malaria", "Tuberculosis", "Cholera", "Diabetes"], answer: "Malaria", subject: "Biology" },
            { question: "29. Homeostasis maintains:", options: ["Body temp", "Blood sugar", "Water balance", "All of the above"], answer: "All of the above", subject: "Biology" },
            { question: "30. Bacteria are:", options: ["Multicellular eukaryotes", "Unicellular prokaryotes", "Viruses", "Fungi"], answer: "Unicellular prokaryotes", subject: "Biology" },
            { question: "31. Avogadro's number ≈", options: ["6.02×10^20", "6.02×10^23", "6.02×10^26", "6.02×10^29"], answer: "6.02×10^23", subject: "Chemistry" },
            { question: "32. Catalyst effect:", options: ["Increases activation energy", "Lowers activation energy", "Changes equilibrium", "Gets consumed"], answer: "Lowers activation energy", subject: "Chemistry" },
            { question: "33. pH of neutral solution:", options: ["7", "1", "14", "0"], answer: "7", subject: "Chemistry" },
            { question: "34. Atomic number = proton count?", options: ["True", "False", "Depends on isotope", "None"], answer: "True", subject: "Chemistry" },
            { question: "35. Ionic bond formed by:", options: ["Sharing electrons", "Transferring electrons", "Metallic bonding", "Nuclear bond"], answer: "Transferring electrons", subject: "Chemistry" },
            { question: "36. Empirical formula of C2H6O?", options: ["C2H6O", "CH3O", "C2H3O", "CH6O2"], answer: "C2H6O", subject: "Chemistry" },
            { question: "37. Gas at room temperature:", options: ["Mercury", "Oxygen", "Gold", "Iron"], answer: "Oxygen", subject: "Chemistry" },
            { question: "38. Matter state with fixed shape:", options: ["Solid", "Liquid", "Gas", "Plasma"], answer: "Solid", subject: "Chemistry" },
            { question: "39. Molecule vs atom:", options: ["Atom > molecule", "Molecule has atoms", "Same thing", "Molecule = ion"], answer: "Molecule has atoms", subject: "Chemistry" },
            { question: "40. Solution concentration measured in:", options: ["Mol/L", "g/L", "% mass", "All"], answer: "All", subject: "Chemistry" },
            { question: "41. SI unit of electric field:", options: ["N/C", "V/m", "Both", "J/C"], answer: "Both", subject: "Physics" },
            { question: "42. Current unit:", options: ["V", "A", "Ω", "W"], answer: "A", subject: "Physics" },
            { question: "43. Ohm's law:", options: ["V=IR", "I=VR", "R=IV", "P=VI"], answer: "V=IR", subject: "Physics" },
            { question: "44. Light speed ~?", options: ["3×10^6 m/s", "3×10^8 m/s", "3×10^10 m/s", "3×10^4 m/s"], answer: "3×10^8 m/s", subject: "Physics" },
            { question: "45. Acceleration due to gravity is approximately:", options: ["9.8 m/s²", "98 m/s²", "0.98 m/s²", "980 m/s²"], answer: "9.8 m/s²", subject: "Physics" },
            { question: "46. What does a fuse do in an electrical circuit?", options: ["Increases current", "Decreases voltage", "Protects from overcurrent", "Stores energy"], answer: "Protects from overcurrent", subject: "Physics" },
            { question: "47. Which of the following is a renewable energy source?", options: ["Coal", "Natural Gas", "Solar", "Nuclear"], answer: "Solar", subject: "Physics" },
            { question: "48. The law of conservation of energy states that energy:", options: ["Can be created and destroyed", "Can only be transformed", "Is always lost as heat", "Is conserved only in ideal systems"], answer: "Can only be transformed", subject: "Physics" },
            { question: "49. What is the phenomenon where light bends as it passes from one medium to another?", options: ["Reflection", "Diffraction", "Refraction", "Interference"], answer: "Refraction", subject: "Physics" },
            { question: "50. Which force keeps planets in orbit around the sun?", options: ["Electromagnetic force", "Strong nuclear force", "Weak nuclear force", "Gravitational force"], answer: "Gravitational force", subject: "Physics" },
            { question: "51. What is the SI unit of power?", options: ["Joule", "Watt", "Volt", "Ampere"], answer: "Watt", subject: "Physics" },
            { question: "52. Which type of mirror produces an inverted image?", options: ["Plane mirror", "Convex mirror", "Concave mirror (if object beyond focal point)", "Both convex and concave"], answer: "Concave mirror (if object beyond focal point)", subject: "Physics" },
            { question: "53. The process of splitting an atom to release energy is called:", options: ["Nuclear fusion", "Nuclear fission", "Radioactive decay", "Chain reaction"], answer: "Nuclear fission", subject: "Physics" },
            { question: "54. What is the unit of resistance?", options: ["Volt", "Ampere", "Ohm", "Watt"], answer: "Ohm", subject: "Physics" },
            { question: "55. First Governor General of Pakistan?", options: ["Liaquat Ali Khan", "Muhammad Ali Jinnah", "Ghulam Muhammad", "Iskander Mirza"], answer: "Muhammad Ali Jinnah", subject: "Pak Studies" },
            { question: "56. Pakistan Resolution passed on?", options: ["March 23, 1940", "August 14, 1947", "September 11, 1948", "October 24, 1954"], answer: "March 23, 1940", subject: "Pak Studies" },
            { question: "57. Pakistan's national poet?", options: ["Faiz Ahmad Faiz", "Allama Muhammad Iqbal", "Ahmed Faraz", "Parveen Shakir"], answer: "Allama Muhammad Iqbal", subject: "Pak Studies" },
            { question: "58. Largest province by area in Pakistan?", options: ["Punjab", "Sindh", "Balochistan", "Khyber Pakhtunkhwa"], answer: "Balochistan", subject: "Pak Studies" },
            { question: "59. Capital of Pakistan?", options: ["Karachi", "Lahore", "Islamabad", "Rawalpindi"], answer: "Islamabad", subject: "Pak Studies" },
            { question: "60. Quaid-e-Azam's tomb located in:", options: ["Lahore", "Islamabad", "Karachi", "Peshawar"], answer: "Karachi", subject: "Pak Studies" },
            { question: "61. Highest peak in Pakistan?", options: ["Nanga Parbat", "Broad Peak", "K2 (Mount Godwin Austen)", "Gasherbrum I"], answer: "K2 (Mount Godwin Austen)", subject: "Pak Studies" },
            { question: "62. Indus Valley Civilization's major site in Sindh:", options: ["Harappa", "Taxila", "Mohenjo-Daro", "Gandhara"], answer: "Mohenjo-Daro", subject: "Pak Studies" },
            { question: "63. National language of Pakistan?", options: ["Punjabi", "Sindhi", "Urdu", "Pashto"], answer: "Urdu", subject: "Pak Studies" },
            { question: "64. First Prime Minister of Pakistan?", options: ["Muhammad Ali Jinnah", "Liaquat Ali Khan", "Khawaja Nazimuddin", "Muhammad Ali Bogra"], answer: "Liaquat Ali Khan", subject: "Pak Studies" },
            { question: "65. Who is the current Chief Justice of Pakistan (as of latest general info)?", options: ["Umar Ata Bandial", "Qazi Faez Isa", "Gulzar Ahmed", "Asif Saeed Khosa"], answer: "Qazi Faez Isa", subject: "Current Affairs" },
            { question: "66. Which country hosted the 2024 Summer Olympics?", options: ["Japan", "France", "USA", "Australia"], answer: "France", subject: "Current Affairs" },
            { question: "67. What is the name of the current UN Secretary-General?", options: ["Kofi Annan", "Ban Ki-moon", "António Guterres", "Boutros Boutros-Ghali"], answer: "António Guterres", subject: "Current Affairs" },
            { question: "68. Which organization aims to promote international peace and security?", options: ["NATO", "ASEAN", "UN", "EU"], answer: "UN", subject: "Current Affairs" },
            { question: "69. What is the current global challenge related to climate?", options: ["Deforestation", "Ocean acidification", "Global warming", "All of the above"], answer: "All of the above", subject: "Current Affairs" },
            { question: "70. Which international body deals with trade rules between countries?", options: ["IMF", "World Bank", "WTO", "UNICEF"], answer: "WTO", subject: "Current Affairs" },
            { question: "71. Who won the Nobel Peace Prize in 2024?", options: ["The answer depends on the year's actual recipient, not predictable", "A prominent environmental activist", "A leader from a conflict zone", "A global health organization"], answer: "The answer depends on the year's actual recipient, not predictable", subject: "Current Affairs" },
            { question: "72. What is the primary focus of the World Health Organization (WHO)?", options: ["Economic development", "Global health", "Human rights", "Environmental protection"], answer: "Global health", subject: "Current Affairs" },
            { question: "73. Which country is known for the Great Barrier Reef?", options: ["Brazil", "Australia", "Canada", "Indonesia"], answer: "Australia", subject: "Current Affairs" },
            { question: "74. What is the purpose of the COP (Conference of the Parties) summits?", options: ["To discuss global economic policies", "To address climate change issues", "To promote cultural exchange", "To resolve international disputes"], answer: "To address climate change issues", subject: "Current Affairs" },
            { question: "75. What is 15% of 200?", options: ["15", "20", "30", "40"], answer: "30", subject: "Math" },
            { question: "76. If x + 5 = 12, then x = ?", options: ["5", "7", "12", "17"], answer: "7", subject: "Math" },
            { question: "77. What is the area of a rectangle with length 8 cm and width 5 cm?", options: ["13 cm²", "26 cm²", "40 cm²", "80 cm²"], answer: "40 cm²", subject: "Math" },
            { question: "78. Solve: 3 * (4 + 2) - 5", options: ["10", "13", "18", "21"], answer: "13", subject: "Math" },
            { question: "79. What is the next number in the sequence: 2, 4, 8, 16, ...?", options: ["20", "24", "32", "64"], answer: "32", subject: "Math" },
            { question: "80. Convert 0.75 to a fraction:", options: ["1/2", "3/4", "1/4", "7/5"], answer: "3/4", subject: "Math" },
            { question: "81. If a shirt costs $25 and is on sale for 20% off, what is the sale price?", options: ["$5", "$15", "$20", "$22"], answer: "$20", subject: "Math" },
            { question: "82. What is the square root of 81?", options: ["7", "8", "9", "18"], answer: "9", subject: "Math" },
            { question: "83. How many sides does a hexagon have?", options: ["5", "6", "7", "8"], answer: "6", subject: "Math" },
            { question: "84. The perimeter of a square with side length 6 cm is:", options: ["6 cm", "12 cm", "24 cm", "36 cm"], answer: "24 cm", subject: "Math" },
            { question: "85. In MS Word, what is the default file extension?", options: [".docx", ".pdf", ".txt", ".xlsx"], answer: ".docx", subject: "Computer Science" },
            { question: "86. What does CPU stand for?", options: ["Central Process Unit", "Central Program Unit", "Control Processing Unit", "Central Processing Unit"], answer: "Central Processing Unit", subject: "Computer Science" },
            { question: "87. Which of these is an input device?", options: ["Printer", "Monitor", "Keyboard", "Speaker"], answer: "Keyboard", subject: "Computer Science" },
            { question: "88. What is RAM?", options: ["Read Access Memory", "Random Access Memory", "Read Only Memory", "Remote Access Module"], answer: "Random Access Memory", subject: "Computer Science" },
            { question: "89. What is an algorithm?", options: ["A programming language", "A step-by-step procedure to solve a problem", "A type of computer hardware", "A database system"], answer: "A step-by-step procedure to solve a problem", subject: "Computer Science" },
            { question: "90. Which protocol is used for sending emails?", options: ["HTTP", "FTP", "SMTP", "TCP"], answer: "SMTP", subject: "Computer Science" },
            { question: "91. What is a 'bug' in computer programming?", options: ["A small insect", "An error or defect in software", "A computer virus", "A hardware component"], answer: "An error or defect in software", subject: "Computer Science" },
            { question: "92. Which programming language is known for web development?", options: ["Python", "Java", "HTML", "C++"], answer: "HTML", subject: "Computer Science" },
            { question: "93. What is the function of an operating system?", options: ["To manage hardware and software resources", "To create documents", "To browse the internet", "To play games"], answer: "To manage hardware and software resources", subject: "Computer Science" },
            { question: "94. What does 'WWW' stand for?", options: ["World Wide Web", "World Wide Widget", "Web World Wide", "Wide Web World"], answer: "World Wide Web", subject: "Computer Science" },
            { question: "95. Which of the following is the largest desert in the world?", options: ["Sahara Desert", "Arabian Desert", "Gobi Desert", "Antarctic Polar Desert"], answer: "Antarctic Polar Desert", subject: "General Knowledge" },
            { question: "96. Who painted the Mona Lisa?", options: ["Vincent van Gogh", "Pablo Picasso", "Leonardo da Vinci", "Claude Monet"], answer: "Leonardo da Vinci", subject: "General Knowledge" },
            { question: "97. What is the chemical symbol for water?", options: ["O2", "CO2", "H2O", "NACL"], answer: "H2O", subject: "General Knowledge" },
            { question: "98. Which planet is known as the 'Red Planet'?", options: ["Earth", "Mars", "Jupiter", "Venus"], answer: "Mars", subject: "General Knowledge" },
            { question: "99. What is the capital of Japan?", options: ["Beijing", "Seoul", "Tokyo", "Bangkok"], answer: "Tokyo", subject: "General Knowledge" },
            { question: "100. How many continents are there in the world?", options: ["5", "6", "7", "8"], answer: "7", subject: "General Knowledge" }
        ];

        // UI Elements
        const welcomeScreen = document.getElementById('welcome-screen');
        const testScreen = document.getElementById('test-screen');
        const resultScreen = document.getElementById('result-screen');

        const nameInput = document.getElementById('name');
        const emailInput = document.getElementById('email');
        const startTestBtn = document.getElementById('start-test-btn');

        const questionProgressDisplay = document.getElementById('question-progress-display');
        const timerDisplay = document.getElementById('timer');
        const progressBar = document.getElementById('progress-fill');
        const questionNumberElem = document.getElementById('question-number');
        const bookmarkBtn = document.getElementById('bookmark-btn');
        const passageDisplay = document.getElementById('passage-display');
        const questionTextElem = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const answeredCountElem = document.getElementById('answered-count');
        const totalQuestionsElem = document.getElementById('total-questions');
        const paletteContainer = document.getElementById('palette');

        const resultScoreElem = document.getElementById('result-score');
        const resultStatusElem = document.getElementById('result-status');
        const correctCountElem = document.getElementById('correct-count');
        const incorrectCountElem = document.getElementById('incorrect-count');
        const timeTakenElem = document.getElementById('time-taken');
        const percentageElem = document.getElementById('percentage');
        const certificateBtn = document.getElementById('certificate-btn');

        const noticeModal = document.getElementById('notice-modal');
        const closeNoticeModalBtn = document.getElementById('close-notice-modal-btn');

        const reviewModal = document.getElementById('review-modal');
        const reviewContent = document.getElementById('review-content');
        const closeReviewModalBtn = document.getElementById('close-review-modal-btn');
        const finalSubmitBtn = document.getElementById('final-submit-btn');

        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');
        // const soundToggle = document.getElementById('sound-toggle'); // Removed
        // const soundIcon = document.getElementById('sound-icon'); // Removed
        const fullscreenToggle = document.getElementById('fullscreen-toggle');
        const fullscreenIcon = document.getElementById('fullscreen-icon');

        // Quiz State Variables
        let currentQuestion = 0;
        let answers = {}; // {questionIndex: selectedOptionText}
        let bookmarkedQuestions = new Set();
        let timeLeft = 100 * 60; // 100 minutes in seconds
        let timerInterval;
        const passMarksPercentage = 40;
        let userName = '';
        let userEmail = '';
        let submissionAttempted = false; // To track if a submission has been made for the user's current session

        // Sounds (Removed all sound-related objects and functions)
        // const clickSound = new Audio('https://www.soundjay.com/buttons/button-2.mp3');
        // const correctSound = new Audio('https://www.soundjay.com/misc/success-sound-2.mp3');
        // const incorrectSound = new Audio('https://www.soundjay.com/misc/fail-sound-2.mp3');
        // const finishSound = new Audio('https://www.soundjay.com/misc/ending-sound-effect.mp3');
        // let soundEnabled = true; // Removed

        // Particle Animation
        function createParticle() {
            const particle = document.createElement('div');
            particle.classList.add('particle');
            document.getElementById('particles').appendChild(particle);

            const size = Math.random() * 5 + 3; // 3 to 8px
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.left = `${Math.random() * 100}%`;
            particle.style.top = `${Math.random() * 100}%`;
            particle.style.animationDuration = `${Math.random() * 5 + 5}s`; // 5 to 10s
            particle.style.animationDelay = `-${Math.random() * 5}s`; // Start at various points

            particle.addEventListener('animationend', () => {
                particle.remove();
            });
        }

        function generateParticles() {
            for (let i = 0; i < 50; i++) { // Generate 50 particles
                createParticle();
            }
            setInterval(createParticle, 500); // Add a new particle every 0.5 seconds
        }

        // Functions
        // function playSound(sound) { // Removed playSound function
        //     if (soundEnabled) {
        //         sound.currentTime = 0;
        //         sound.play().catch(e => console.error("Error playing sound:", e));
        //     }
        // }

        function toggleTheme() {
            document.documentElement.toggleAttribute('data-theme');
            const isDarkMode = document.documentElement.hasAttribute('data-theme');
            themeIcon.className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            // playSound(clickSound); // Removed
        }

        // function toggleSound() { // Removed toggleSound function
        //     soundEnabled = !soundEnabled;
        //     soundIcon.className = soundEnabled ? 'fas fa-volume-up' : 'fas fa-volume-mute';
        //     localStorage.setItem('soundEnabled', soundEnabled);
        // }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().then(() => {
                    fullscreenIcon.className = 'fas fa-compress';
                }).catch(err => {
                    console.error(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
                    alert('Fullscreen mode could not be activated. Your browser may block it.');
                });
            } else {
                document.exitFullscreen().then(() => {
                    fullscreenIcon.className = 'fas fa-expand';
                }).catch(err => {
                    console.error(`Error attempting to exit full-screen mode: ${err.message} (${err.name})`);
                });
            }
            // playSound(clickSound); // Removed
        }

        function loadQuestion(index) {
            currentQuestion = index;
            const question = questions[currentQuestion];

            questionNumberElem.textContent = `Question ${currentQuestion + 1}`;
            questionProgressDisplay.textContent = `Question ${currentQuestion + 1} of ${questions.length}`;

            // Handle Passage
            if (question.passage) {
                passageDisplay.textContent = question.passage;
                passageDisplay.classList.remove('hidden');
            } else {
                passageDisplay.classList.add('hidden');
            }
            questionTextElem.textContent = question.question;

            optionsContainer.innerHTML = '';
            question.options.forEach((option, idx) => {
                const optionDiv = document.createElement('div');
                optionDiv.classList.add('option');
                optionDiv.innerHTML = `
                    <input type="radio" id="option${idx}" name="question${currentQuestion}" value="${option}">
                    <label for="option${idx}">${option}</label>
                `;
                optionDiv.addEventListener('click', () => {
                    selectOption(option);
                    // playSound(clickSound); // Removed
                });
                optionsContainer.appendChild(optionDiv);

                // Pre-select if already answered
                if (answers[currentQuestion] === option) {
                    optionDiv.classList.add('selected');
                    optionDiv.querySelector('input').checked = true;
                }
            });

            // Update navigation buttons
            prevBtn.disabled = currentQuestion === 0;
            nextBtn.disabled = currentQuestion === questions.length - 1;

            if (currentQuestion === questions.length - 1) {
                nextBtn.classList.add('hidden');
                submitBtn.classList.remove('hidden');
            } else {
                nextBtn.classList.remove('hidden');
                submitBtn.classList.add('hidden');
            }

            updatePalette();
            updateBookmarkButton();
            updateProgress();
        }

        function selectOption(selectedOption) {
            answers[currentQuestion] = selectedOption;
            updatePalette(); // Mark question as answered in palette
            updateProgress(); // Update answered count and progress bar
            // Visually update selected option
            optionsContainer.querySelectorAll('.option').forEach(optDiv => {
                optDiv.classList.remove('selected');
                optDiv.querySelector('input').checked = false;
            });
            const selectedDiv = Array.from(optionsContainer.querySelectorAll('.option')).find(optDiv =>
                optDiv.querySelector('input').value === selectedOption
            );
            if (selectedDiv) {
                selectedDiv.classList.add('selected');
                selectedDiv.querySelector('input').checked = true;
            }
        }

        function updatePalette() {
            paletteContainer.innerHTML = '';
            questions.forEach((_, index) => {
                const paletteBtn = document.createElement('button');
                paletteBtn.classList.add('palette-btn');
                paletteBtn.textContent = index + 1;
                paletteBtn.addEventListener('click', () => {
                    loadQuestion(index);
                    // playSound(clickSound); // Removed
                });

                if (index === currentQuestion) {
                    paletteBtn.classList.add('current');
                }
                if (answers[index]) {
                    paletteBtn.classList.add('answered');
                }
                if (bookmarkedQuestions.has(index)) {
                    paletteBtn.classList.add('bookmarked');
                }
                paletteContainer.appendChild(paletteBtn);
            });
        }

        function updateProgress() {
            const answeredCount = Object.keys(answers).length;
            answeredCountElem.textContent = answeredCount;
            totalQuestionsElem.textContent = questions.length;

            const progressPercentage = (answeredCount / questions.length) * 100;
            progressBar.style.width = `${progressPercentage}%`;
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDisplay.textContent = `Time Left: ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitTest(true); // Auto-submit when time runs out
                }
            }, 1000);
        }

        function updateBookmarkButton() {
            if (bookmarkedQuestions.has(currentQuestion)) {
                bookmarkBtn.classList.add('active');
            } else {
                bookmarkBtn.classList.remove('active');
            }
        }

        function toggleBookmark() {
            if (bookmarkedQuestions.has(currentQuestion)) {
                bookmarkedQuestions.delete(currentQuestion);
            } else {
                bookmarkedQuestions.add(currentQuestion);
            }
            updateBookmarkButton();
            updatePalette(); // Update palette to show bookmark status
            // playSound(clickSound); // Removed
        }

        async function submitTest(timeUp = false) {
            // playSound(clickSound); // Removed

            // If time is up, directly proceed to review/result if no submission attempted
            if (timeUp && submissionAttempted) {
                return; // Prevent multiple submissions if timer runs out after manual submission
            }

            if (!timeUp && Object.keys(answers).length < questions.length) {
                // Show review modal if not all questions are answered
                showReviewModal();
            } else {
                // Directly calculate and show results if all answered or time is up
                if (!submissionAttempted) { // Prevent double submission
                    await calculateResult(timeUp);
                }
            }
        }


        async function calculateResult(timeUp = false) {
            if (submissionAttempted) return; // Prevent multiple submissions
            submissionAttempted = true;

            clearInterval(timerInterval); // Stop the timer

            let correctAnswers = 0;
            let incorrectAnswers = 0;
            const unansweredQuestions = questions.length - Object.keys(answers).length;
            
            questions.forEach((q, index) => {
                if (answers[index]) {
                    if (answers[index] === q.answer) {
                        correctAnswers++;
                    } else {
                        incorrectAnswers++;
                    }
                }
            });

            const totalScore = correctAnswers;
            const percentage = (totalScore / questions.length) * 100;
            const timeTakenInSeconds = (100 * 60) - timeLeft; // Total time - remaining time
            const timeTakenMinutes = Math.floor(timeTakenInSeconds / 60);
            const timeTakenSeconds = timeTakenInSeconds % 60;

            const resultData = {
                name: userName,
                email: userEmail,
                score: totalScore,
                totalQuestions: questions.length,
                correct: correctAnswers,
                incorrect: incorrectAnswers,
                unanswered: unansweredQuestions,
                percentage: percentage.toFixed(2),
                timeTaken: `${timeTakenMinutes}:${String(timeTakenSeconds).padStart(2, '0')}`,
                passStatus: percentage >= passMarksPercentage ? "Pass" : "Fail",
                timestamp: serverTimestamp() // Use server timestamp
            };

            await saveResultToFirestore(resultData);
            showResult(resultData);
        }

        async function saveResultToFirestore(resultData) {
            if (!firebaseInitialized) {
                console.warn('Firebase not initialized. Result will not be saved.');
                return;
            }

            try {
                // Authenticate anonymously
                const userCredential = await signInAnonymously(auth);
                const user = userCredential.user;
                console.log("Anonymous user signed in:", user.uid);

                // Check if user has already submitted a test
                const resultsRef = collection(db, "results");
                const q = query(resultsRef, where("email", "==", userEmail));
                const querySnapshot = await getDocs(q);

                if (!querySnapshot.empty) {
                    console.warn('A test result for this email already exists. Skipping new submission.');
                    alert('A test has already been submitted with this email address. You can only take the test once.');
                    return; // Do not save if already submitted
                }

                await addDoc(resultsRef, resultData);
                console.log("Document successfully written!");
            } catch (e) {
                console.error("Error adding document: ", e);
                alert("Could not save your result. Please try again later or contact support. Error: " + e.message);
            }
        }


        function showResult(resultData) {
            testScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');

            resultScoreElem.textContent = `${resultData.score} / ${resultData.totalQuestions}`;
            resultStatusElem.textContent = resultData.passStatus === "Pass" ? "Mubarak Ho! Aap Pass Ho Gaye!" : "Afsoos! Aap Fail Ho Gaye.";
            resultStatusElem.className = resultData.passStatus === "Pass" ? "result-status pass" : "result-status fail";
            correctCountElem.textContent = resultData.correct;
            incorrectCountElem.textContent = resultData.incorrect;
            timeTakenElem.textContent = resultData.timeTaken;
            percentageElem.textContent = `${resultData.percentage}%`;

            if (resultData.passStatus === "Pass") {
                // playSound(correctSound); // Removed
                certificateBtn.style.display = 'block'; // Show certificate button if passed
            } else {
                // playSound(incorrectSound); // Removed
                certificateBtn.style.display = 'none'; // Hide certificate button if failed
            }
            // playSound(finishSound); // Removed
        }

        function showReviewModal() {
            reviewContent.innerHTML = ''; // Clear previous content
            questions.forEach((q, index) => {
                const userAnswer = answers[index];
                const isAnswered = userAnswer !== undefined;
                const isCorrect = isAnswered && userAnswer === q.answer;
                const isBookmarked = bookmarkedQuestions.has(index);

                const questionReviewDiv = document.createElement('div');
                questionReviewDiv.style.marginBottom = '1.5rem';
                questionReviewDiv.style.padding = '1rem';
                questionReviewDiv.style.border = `1px solid ${isCorrect ? 'var(--success-color)' : isAnswered ? 'var(--danger-color)' : 'var(--border-color)'}`;
                questionReviewDiv.style.borderRadius = '10px';
                questionReviewDiv.style.background = isCorrect ? 'rgba(76, 175, 80, 0.05)' : isAnswered ? 'rgba(244, 67, 57, 0.05)' : 'var(--bg-secondary)';
                
                questionReviewDiv.innerHTML = `
                    <p style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">
                        Question ${index + 1}: ${q.question}
                        ${isBookmarked ? '<i class="fas fa-bookmark" style="color: var(--warning-color); margin-left: 0.5rem;"></i>' : ''}
                    </p>
                    <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">
                        Your Answer: <span style="font-weight: 500; color: ${isAnswered ? 'var(--text-primary)' : 'var(--danger-color)'};">${isAnswered ? userAnswer : 'Not Answered'}</span>
                    </p>
                    ${isAnswered ? `<p style="color: var(--text-secondary);">
                        Status: <span style="font-weight: 500; color: ${isCorrect ? 'var(--success-color)' : 'var(--danger-color)'};">
                            ${isCorrect ? '<i class="fas fa-check-circle"></i> Correct' : '<i class="fas fa-times-circle"></i> Incorrect'}
                        </span>
                    </p>` : ''}
                `;
                reviewContent.appendChild(questionReviewDiv);
            });

            reviewModal.classList.remove('hidden');
        }


        function resetTest() {
            currentQuestion = 0;
            answers = {};
            bookmarkedQuestions = new Set();
            timeLeft = 100 * 60;
            submissionAttempted = false; // Reset submission flag
            clearInterval(timerInterval);
            timerDisplay.textContent = `Time Left: 100:00`;
            loadQuestion(0);
            welcomeScreen.classList.remove('hidden');
            testScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            noticeModal.classList.remove('hidden'); // Show notice again for new test
            nameInput.value = '';
            emailInput.value = '';
        }

        // Event Listeners
        startTestBtn.addEventListener('click', async () => {
            userName = nameInput.value.trim();
            userEmail = emailInput.value.trim();

            if (!userName || !userEmail) {
                alert('Please enter your name and email to start the test.');
                return;
            }

            // Simple email validation
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(userEmail)) {
                alert('Please enter a valid email address.');
                return;
            }

            if (firebaseInitialized) {
                // Check if user already submitted
                try {
                    const q = query(collection(db, "results"), where("email", "==", userEmail));
                    const querySnapshot = await getDocs(q);
                    if (!querySnapshot.empty) {
                        alert('A test has already been submitted with this email address. You can only take the test once.');
                        return;
                    }
                } catch (e) {
                    console.error("Error checking existing submission:", e);
                    alert("Could not check previous submissions. Please try again.");
                    return;
                }
            } else {
                alert('Firebase is not initialized. Test results cannot be saved. Please check console for errors.');
                // Optionally, you could still let them take the test without saving results
                // if (!confirm("Firebase is not initialized, results cannot be saved. Do you want to proceed anyway?")) {
                //     return;
                // }
            }
            
            noticeModal.classList.add('hidden');
            welcomeScreen.classList.add('hidden');
            testScreen.classList.remove('hidden');
            loadQuestion(0);
            startTimer();
            generateParticles();
            // playSound(clickSound); // Removed
        });

        prevBtn.addEventListener('click', () => {
            if (currentQuestion > 0) {
                loadQuestion(currentQuestion - 1);
                // playSound(clickSound); // Removed
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestion < questions.length - 1) {
                loadQuestion(currentQuestion + 1);
                // playSound(clickSound); // Removed
            }
        });

        submitBtn.addEventListener('click', () => submitTest());
        bookmarkBtn.addEventListener('click', toggleBookmark);

        closeNoticeModalBtn.addEventListener('click', () => {
            noticeModal.classList.add('hidden');
            // playSound(clickSound); // Removed
        });

        closeReviewModalBtn.addEventListener('click', () => {
            reviewModal.classList.add('hidden');
            // playSound(clickSound); // Removed
        });

        finalSubmitBtn.addEventListener('click', async () => {
            reviewModal.classList.add('hidden');
            await calculateResult();
            // playSound(clickSound); // Removed
        });

        themeToggle.addEventListener('click', toggleTheme);
        // soundToggle.addEventListener('click', toggleSound); // Removed
        fullscreenToggle.addEventListener('click', toggleFullscreen);

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (testScreen.classList.contains('hidden')) return; // Only active on test screen

            switch (e.key) {
                case 'ArrowLeft':
                    if (currentQuestion > 0) {
                        e.preventDefault();
                        loadQuestion(currentQuestion - 1);
                    }
                    break;
                case 'ArrowRight':
                    if (currentQuestion < questions.length - 1) {
                        e.preventDefault();
                        loadQuestion(currentQuestion + 1);
                    }
                    break;
                case '1':
                case '2':
                case '3':
                case '4':
                    e.preventDefault();
                    const optionIndex = parseInt(e.key) - 1;
                    const currentQ = questions[currentQuestion];
                    if (optionIndex < currentQ.options.length) {
                        selectOption(currentQ.options[optionIndex]);
                    }
                    break;
                case 'b':
                case 'B':
                    e.preventDefault();
                    toggleBookmark();
                    break;
            }
        });

        // Auto-save functionality
        setInterval(() => {
            if (!testScreen.classList.contains('hidden')) {
                localStorage.setItem('mockTestProgress', JSON.stringify({
                    currentQuestion,
                    answers,
                    bookmarkedQuestions: Array.from(bookmarkedQuestions),
                    timeLeft
                }));
            }
        }, 10000);

        // Load saved progress (on window load, but clear it if user doesn't want to be prompted)
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('mockTestProgress');
            if (saved) {
                // As per previous instruction, clear saved progress if user doesn't want to be prompted.
                localStorage.removeItem('mockTestProgress');
            }
        });
    </script>
</body>
</html>